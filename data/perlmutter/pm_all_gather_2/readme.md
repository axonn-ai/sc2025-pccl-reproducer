with both nccl and mpi as the outer communication library